{"version":3,"file":"live-edit2.js","sources":["webpack://microweber-webpack/./userfiles/modules/microweber/api/liveedit2/@live.js","webpack://microweber-webpack/./userfiles/modules/microweber/api/liveedit2/element-types.js","webpack://microweber-webpack/webpack/bootstrap","webpack://microweber-webpack/webpack/runtime/define property getters","webpack://microweber-webpack/webpack/runtime/hasOwnProperty shorthand","webpack://microweber-webpack/webpack/runtime/make namespace object","webpack://microweber-webpack/webpack/startup"],"sourcesContent":["\n/* jshint esversion: 6 */\n/* globals: mw */\n\nimport {ElementAnalizer} from './element-types';\n\n\nexport const LiveEdit = function (options) {\n\n    var _e = {};\n    this.on = function (e, f) { _e[e] ? _e[e].push(f) : (_e[e] = [f]) };\n    this.dispatch = function (e, f) { _e[e] ? _e[e].forEach(function (c){ c.call(this, f); }) : ''; };\n\n    var defaults = {\n        elementClass: 'element',\n        cloneableClass: 'cloneable',\n        editClass: 'edit',\n        moduleClass: 'module',\n        rowClass: 'mw-row',\n        colClass: 'mw-col',\n        safeElementClass: 'safe-element',\n        plainElementClass: 'plain-text',\n        emptyElementClass: 'empty-element',\n        nodrop: 'nodrop',\n        allowDrop: 'allow-drop',\n        unEditableModules: [\n            '[type=\"template_settings\"]'\n        ],\n        frameworksClasses: {\n            col: []\n        }\n    };\n\n    this.settings = mw.object.extend({}, defaults, options);\n\n    this.elementAnalyzer = new ElementAnalizer(this.settings);\n\n    // action: append, prepend, before, after\n    this.insertElement = function (candidate, target, action) {\n        this.dispatch('beforeElementInsert', {candidate: candidate, target: target, action: action});\n        mw.element(target)[action](candidate);\n        this.dispatch('elementInsert', {candidate: candidate, target: target, action: action});\n    };\n\n    this.moveElement = function (candidate, target, action) {\n        this.dispatch('beforeElementMove', {candidate: candidate, target: target, action: action});\n        mw.element(target)[action](candidate);\n        this.dispatch('elementMove', {candidate: candidate, target: target, action: action});\n    };\n\n};\n","/* jshint esversion: 6 */\n/* globals: mw */\n\n\nexport const ElementAnalyzerService = function (settings) {\n\n    var dropableElements;\n\n    this.isConfigurable = function (target) {\n        return this.isElement(target) || this.isModule(target) || this.isRow(target);\n    };\n\n    this.isRow = function(node) {\n        return mw.tools.hasClass(node, this.settings.rowClass);\n    };\n\n    this.isModuleButNotLayout = function(node) {\n        return node.dataset.type !== 'layouts';\n    };\n    this.isLayout = function(node) {\n        return node.dataset.type === 'layouts';\n    };\n\n    this.isEditableLayout = function(node) {\n        return this.this.isLayout(node) && this.isInEdit(node);\n    };\n\n    this.isEditableModule = function(node) {\n        return this.isModule(node) && this.isInEdit(node);\n    };\n\n    this.isElement = function(node) {\n        return mw.tools.hasClass(node, this.settings.elementClass);\n    };\n\n    this.isEmpty = function(node) {\n        return mw.tools.hasClass(node, this.settings.emptyElementClass);\n    };\n\n    var _tagsCanAccept = ['DIV', 'ARTICLE', 'ASIDE', 'FOOTER', 'HEADER', 'MAIN', 'SECTION', 'DD', 'LI', 'TD', 'FORM'];\n\n    this.canAcceptByClass = function (node) {\n        return mw.tools.hasAnyOfClasses(node, this.dropableElements());\n    };\n\n    this.canAcceptByTag = function (node) {\n        if(!node || node.nodeType !== 1) return false;\n        return _tagsCanAccept.indexOf(node.nodeName) !== -1;\n    };\n\n    this.isEdit = function(node) {\n        return mw.tools.hasClass(node, this.settings.editClass);\n    };\n\n    this.isInEdit = function(node) {\n        var order = [\n            this.settings.editClass,\n            this.settings.moduleClass,\n        ];\n        return mw.tools.parentsOrCurrentOrderMatchOrOnlyFirst(node.parentNode, order);\n    };\n\n    this.isEditOrInEdit = function (node) {\n        return this.isEdit(node) || this.isInEdit(node);\n    };\n\n    this.allowDrop = function (node) {\n        return mw.tools.parentsOrCurrentOrderMatchOrOnlyFirstOrNone(node, [this.settings.allowDrop, this.settings.nodrop]);\n    };\n\n    this.canInsertBeforeOrAfter = function (node) {\n        return this.canAccept(node.parentNode);\n    };\n\n\n    this.isPlainText = function (node) {\n        return mw.tools.hasClass(node, this.settings.plainElementClass);\n    };\n\n    this.canAccept = function (target) {\n        if (this.canAcceptByTag(target)\n            && this.canAcceptByClass(target)\n            && this.isEditOrInEdit(target)\n            && this.allowDrop(target)) {\n        }\n        return false;\n    };\n\n    this.dropableElements = function (){\n        return dropableElements;\n    };\n\n    this.getTarget = function (node) {\n        if (!node || node === document.body) return null;\n        if (this.canAccept(node)) {\n            return node;\n        } else {\n            return this.getTarget(node.parentElement);\n        }\n    };\n\n    this.init = function () {\n        this.settings = settings;\n        dropableElements = [\n            settings.elementClass,\n            settings.cloneableClass,\n            settings.editClass,\n            settings.moduleClass,\n            settings.colClass,\n            settings.allowDrop,\n        ];\n    };\n\n    this.getPosition()\n\n    this.init();\n};\n\n\n\n\nexport const ElementAnalizer = function (options) {\n    options = options || {};\n\n    this.settings = options;\n\n    this.service = new ElementAnalyzerService(this.settings);\n\n};\n\n\n\n(function (){\n    var MenuItem = function (data, scope) {\n        var btn = document.createElement('span');\n        btn.className = 'mw-handle-menu-item';\n        if(data.icon) {\n            var iconClass = data.icon;\n            if (iconClass.indexOf('mdi-') === 0) {\n                iconClass = 'mdi ' + iconClass;\n            }\n            var icon = document.createElement('span');\n            icon.className = iconClass + ' mw-handle-menu-item-icon';\n            btn.appendChild(icon);\n        }\n        btn.appendChild(document.createTextNode(data.title));\n        if(data.className){\n            btn.className += (' ' + data.className);\n        }\n        if(data.id){\n            btn.id = data.id;\n        }\n        if(typeof data.visible === 'function'){\n            if(!data.visible()) {\n                btn.style.display = 'none';\n            }\n        }\n        if(data.action){\n            btn.onclick = function (e) {\n                e.preventDefault();\n                data.action.call(scope, e, this, data);\n            };\n        }\n        return btn;\n    };\n    var MenuItems = {\n        module: [\n            {\n                title: 'Edit HTML',\n                icon: 'mw-icon-code',\n                action: function () {\n                    mw.editSource(mw._activeElementOver);\n                }\n            },\n            {\n                title: 'Edit Style',\n                icon: 'mdi mdi-layers',\n                action: function () {\n                    mw.liveEditSettings.show();\n                    mw.sidebarSettingsTabs.set(3);\n                    if(mw.cssEditorSelector){\n                        mw.liveEditSelector.active(true);\n                        mw.liveEditSelector.select(mw._activeElementOver);\n                    } else {\n                        mw.$(mw.liveEditWidgets.cssEditorInSidebarAccordion()).on('load', function () {\n                            setTimeout(function(){\n                                mw.liveEditSelector.active(true);\n                                mw.liveEditSelector.select(mw._activeElementOver);\n                            }, 333);\n                        });\n                    }\n                    mw.liveEditWidgets.cssEditorInSidebarAccordion();\n                }\n            },\n            {\n                title: 'Remove',\n                icon: 'mw-icon-bin',\n                className:'mw-handle-remove',\n                action: function () {\n                    mw.drag.delete_element(mw._activeElementOver);\n                    mw.handleElement.hide()\n                }\n            }\n        ]\n\n};\n    var ElementAnalizer = function (options) {\n\n    };\n})();\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// startup\n// Load entry module\n__webpack_require__(\"./userfiles/modules/microweber/api/liveedit2/@live.js\");\n// This entry module used 'exports' so it can't be inlined\n"],"mappings":";;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;ACnNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACPA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACNA;AACA;AACA;AACA;;A","sourceRoot":""}